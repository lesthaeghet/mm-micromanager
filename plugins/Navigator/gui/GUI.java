package gui;


import acq.CustomAcqEngine;
import com.sun.imageio.plugins.common.ImageUtil;
import ij.gui.ImageWindow;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.image.BufferedImage;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.border.LineBorder;
import org.jdesktop.swingx.*;
import org.jdesktop.swingx.multislider.DefaultMultiThumbModel;
import org.jdesktop.swingx.multislider.MultiThumbModel;
import org.micromanager.MMStudioMainFrame;
import org.micromanager.imagedisplay.VirtualAcquisitionDisplay;
import org.micromanager.utils.GUIUtils;
import org.micromanager.utils.ImageFocusListener;


/**
 *
 * @author Henry
 */
public class GUI extends javax.swing.JFrame implements ImageFocusListener {

   
   private CustomAcqEngine eng_;
   private DisplayPlus currentDisplay_;
           
           
   public GUI() {
      initComponents();
      this.setVisible(true);
      eng_ = new CustomAcqEngine(MMStudioMainFrame.getInstance().getCore());
      GUIUtils.registerImageFocusListener(this);
   }
     
   @Override
   public void focusReceived(ImageWindow focusedWindow) {
       if (focusedWindow == null) {
           currentDisplay_ = null;
           return;
       }
      Object disp = VirtualAcquisitionDisplay.getDisplay(focusedWindow.getImagePlus());
      if (disp == null || !(disp instanceof DisplayPlus) ) {
         currentDisplay_ = null;
      } else {
         currentDisplay_ = (DisplayPlus) disp;
      }
      //TODO enable GUI controls specific to window type
   }
   
   private void updateExploreSettings() {
      eng_.updateExploreSettings(zTopSlider_.getValue(),zBottomSlider_.getValue());
   }
   

   /**
    * This method is called from within the constructor to initialize the form.
    * WARNING: Do NOT modify this code. The content of this method is always
    * regenerated by the Form Editor.
    */
   @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        zSliderPanel_ = new javax.swing.JPanel();
        zTextField_ = new javax.swing.JTextField();
        zSlider_ = new javax.swing.JSlider();
        propertiesPanel_ = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        exploreControlsPanel_ = new javax.swing.JPanel();
        newExploreWindowButton_ = new javax.swing.JButton();
        jSeparator2 = new javax.swing.JSeparator();
        jLabel5 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jTextField3 = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        windowControlsPanel = new javax.swing.JPanel();
        numRowsSpinner_ = new javax.swing.JSpinner();
        rowsLabel_ = new javax.swing.JLabel();
        colsLabel_ = new javax.swing.JLabel();
        numColsSpinner_ = new javax.swing.JSpinner();
        createGridButton_ = new javax.swing.JButton();
        fullResButton_ = new javax.swing.JButton();
        jSeparator3 = new javax.swing.JSeparator();
        pixelOverlapXLabel_ = new javax.swing.JLabel();
        pixelOverlapXSpinner_ = new javax.swing.JSpinner();
        pixelOverlapYLabel_ = new javax.swing.JLabel();
        pixelOverlapYSpinner_ = new javax.swing.JSpinner();
        newGridButton_ = new javax.swing.JToggleButton();
        jPanel1 = new javax.swing.JPanel();
        jSeparator4 = new javax.swing.JSeparator();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        zTopTextField_ = new javax.swing.JTextField();
        zBottomTextField_ = new javax.swing.JTextField();
        zTopSlider_ = new javax.swing.JSlider();
        zBottomSlider_ = new javax.swing.JSlider();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        zTextField_.setText("jTextField1");

        javax.swing.GroupLayout zSliderPanel_Layout = new javax.swing.GroupLayout(zSliderPanel_);
        zSliderPanel_.setLayout(zSliderPanel_Layout);
        zSliderPanel_Layout.setHorizontalGroup(
            zSliderPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(zSliderPanel_Layout.createSequentialGroup()
                .addComponent(zTextField_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(zSlider_, javax.swing.GroupLayout.PREFERRED_SIZE, 396, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        zSliderPanel_Layout.setVerticalGroup(
            zSliderPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(zSlider_, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addComponent(zTextField_, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        jLabel1.setText("add focus changable props here");

        javax.swing.GroupLayout propertiesPanel_Layout = new javax.swing.GroupLayout(propertiesPanel_);
        propertiesPanel_.setLayout(propertiesPanel_Layout);
        propertiesPanel_Layout.setHorizontalGroup(
            propertiesPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator1, javax.swing.GroupLayout.Alignment.TRAILING)
            .addGroup(propertiesPanel_Layout.createSequentialGroup()
                .addGap(143, 143, 143)
                .addComponent(jLabel1)
                .addContainerGap())
        );
        propertiesPanel_Layout.setVerticalGroup(
            propertiesPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(propertiesPanel_Layout.createSequentialGroup()
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel1)
                .addContainerGap())
        );

        newExploreWindowButton_.setText("New explore window");
        newExploreWindowButton_.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newExploreWindowButton_ActionPerformed(evt);
            }
        });

        jLabel5.setText("Z step size");

        jTextField1.setText("jTextField1");

        jLabel6.setText("Saving directory");

        jLabel7.setText("Saving name");

        jTextField2.setText("jTextField2");

        jTextField3.setText("jTextField3");

        jButton1.setText("Browse");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout exploreControlsPanel_Layout = new javax.swing.GroupLayout(exploreControlsPanel_);
        exploreControlsPanel_.setLayout(exploreControlsPanel_Layout);
        exploreControlsPanel_Layout.setHorizontalGroup(
            exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator2)
            .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                        .addComponent(newExploreWindowButton_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel5)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 296, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jButton1))
                            .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                                .addComponent(jLabel7)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, 366, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap())
        );
        exploreControlsPanel_Layout.setVerticalGroup(
            exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(exploreControlsPanel_Layout.createSequentialGroup()
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(newExploreWindowButton_)
                    .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel5)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(exploreControlsPanel_Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(36, Short.MAX_VALUE))
        );

        numRowsSpinner_.setModel(new javax.swing.SpinnerNumberModel(3, 1, 65536, 1));
        numRowsSpinner_.setEnabled(false);
        numRowsSpinner_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                numRowsSpinner_StateChanged(evt);
            }
        });

        rowsLabel_.setText("Rows");
        rowsLabel_.setEnabled(false);

        colsLabel_.setText("Columns");
        colsLabel_.setEnabled(false);

        numColsSpinner_.setModel(new javax.swing.SpinnerNumberModel(3, 1, 65536, 1));
        numColsSpinner_.setEnabled(false);
        numColsSpinner_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                numColsSpinner_StateChanged(evt);
            }
        });

        createGridButton_.setText("Create");
        createGridButton_.setEnabled(false);

        fullResButton_.setText("Full resolution");
        fullResButton_.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                fullResButton_ActionPerformed(evt);
            }
        });

        pixelOverlapXLabel_.setText("Pixel overlap  x");
        pixelOverlapXLabel_.setEnabled(false);

        pixelOverlapXSpinner_.setModel(new javax.swing.SpinnerNumberModel(0, 0, 1024, 1));
        pixelOverlapXSpinner_.setEnabled(false);
        pixelOverlapXSpinner_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                pixelOverlapXSpinner_StateChanged(evt);
            }
        });

        pixelOverlapYLabel_.setText("y");
        pixelOverlapYLabel_.setEnabled(false);

        pixelOverlapYSpinner_.setModel(new javax.swing.SpinnerNumberModel(0, 0, 1024, 1));
        pixelOverlapYSpinner_.setEnabled(false);
        pixelOverlapYSpinner_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                pixelOverlapYSpinner_StateChanged(evt);
            }
        });

        newGridButton_.setText("New Grid");
        newGridButton_.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newGridButton_ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout windowControlsPanelLayout = new javax.swing.GroupLayout(windowControlsPanel);
        windowControlsPanel.setLayout(windowControlsPanelLayout);
        windowControlsPanelLayout.setHorizontalGroup(
            windowControlsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator3)
            .addGroup(windowControlsPanelLayout.createSequentialGroup()
                .addGroup(windowControlsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(fullResButton_)
                    .addGroup(windowControlsPanelLayout.createSequentialGroup()
                        .addComponent(newGridButton_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(rowsLabel_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(numRowsSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(colsLabel_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(numColsSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pixelOverlapXLabel_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pixelOverlapXSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pixelOverlapYLabel_)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pixelOverlapYSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(createGridButton_)))
                .addContainerGap())
        );
        windowControlsPanelLayout.setVerticalGroup(
            windowControlsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(windowControlsPanelLayout.createSequentialGroup()
                .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(windowControlsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rowsLabel_)
                    .addComponent(numRowsSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(colsLabel_)
                    .addComponent(numColsSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(createGridButton_)
                    .addComponent(pixelOverlapXLabel_)
                    .addComponent(pixelOverlapXSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(pixelOverlapYLabel_)
                    .addComponent(pixelOverlapYSpinner_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(newGridButton_))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(fullResButton_))
        );

        jLabel3.setText("Z top");

        jLabel4.setText("Z bottom");

        zTopTextField_.setText("jTextField1");
        zTopTextField_.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                zTopTextField_ActionPerformed(evt);
            }
        });
        zTopTextField_.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                zTopTextField_FocusLost(evt);
            }
        });

        zBottomTextField_.setText("jTextField2");
        zBottomTextField_.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                zBottomTextField_ActionPerformed(evt);
            }
        });
        zBottomTextField_.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                zBottomTextField_FocusLost(evt);
            }
        });

        zTopSlider_.setMajorTickSpacing(1);
        zTopSlider_.setMaximum(50);
        zTopSlider_.setSnapToTicks(true);
        zTopSlider_.setValue(0);
        zTopSlider_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                zTopSlider_StateChanged(evt);
            }
        });

        zBottomSlider_.setMajorTickSpacing(1);
        zBottomSlider_.setMaximum(50);
        zBottomSlider_.setSnapToTicks(true);
        zBottomSlider_.setValue(0);
        zBottomSlider_.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                zBottomSlider_StateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator4, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 481, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(zTopTextField_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(zTopSlider_, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(zBottomTextField_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(zBottomSlider_, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel3)
                        .addComponent(zTopTextField_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(zTopSlider_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel4)
                        .addComponent(zBottomTextField_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(zBottomSlider_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(32, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(propertiesPanel_, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(windowControlsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addComponent(zSliderPanel_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
            .addComponent(exploreControlsPanel_, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(zSliderPanel_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(22, 22, 22)
                .addComponent(propertiesPanel_, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(exploreControlsPanel_, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(windowControlsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(70, 70, 70)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(19, 19, 19))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

   private void newExploreWindowButton_ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newExploreWindowButton_ActionPerformed
      eng_.newExploreWindow(zTopSlider_.getValue(),zBottomSlider_.getValue());
   }//GEN-LAST:event_newExploreWindowButton_ActionPerformed

   private void fullResButton_ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_fullResButton_ActionPerformed

   }//GEN-LAST:event_fullResButton_ActionPerformed

   private void gridSizeChanged() {
      currentDisplay_.resizeGrid((Integer) numRowsSpinner_.getValue(),
              (Integer) numColsSpinner_.getValue(),
              (Integer) pixelOverlapXSpinner_.getValue(),
              (Integer) pixelOverlapYSpinner_.getValue());
   }
 
   private void numRowsSpinner_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_numRowsSpinner_StateChanged
      gridSizeChanged();
   }//GEN-LAST:event_numRowsSpinner_StateChanged

   private void numColsSpinner_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_numColsSpinner_StateChanged
      gridSizeChanged();
   }//GEN-LAST:event_numColsSpinner_StateChanged

   private void pixelOverlapXSpinner_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_pixelOverlapXSpinner_StateChanged
      gridSizeChanged();
   }//GEN-LAST:event_pixelOverlapXSpinner_StateChanged

   private void pixelOverlapYSpinner_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_pixelOverlapYSpinner_StateChanged
      gridSizeChanged();
   }//GEN-LAST:event_pixelOverlapYSpinner_StateChanged

   private void newGridButton_ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newGridButton_ActionPerformed
      boolean newGrid = newGridButton_.isSelected();
      newGridButton_.setText(newGrid ?  "Cancel" : "New grid" );
      numColsSpinner_.setEnabled(newGrid);
      numRowsSpinner_.setEnabled(newGrid);
      pixelOverlapXLabel_.setEnabled(newGrid);
      pixelOverlapXSpinner_.setEnabled(newGrid);
      pixelOverlapYLabel_.setEnabled(newGrid);
      pixelOverlapYSpinner_.setEnabled(newGrid);
      rowsLabel_.setEnabled(newGrid);
      colsLabel_.setEnabled(newGrid);
      createGridButton_.setEnabled(newGrid);
      currentDisplay_.newGrid(newGrid,(Integer) numRowsSpinner_.getValue(),
              (Integer) numColsSpinner_.getValue(),
              (Integer) pixelOverlapXSpinner_.getValue(),
              (Integer) pixelOverlapYSpinner_.getValue());
   }//GEN-LAST:event_newGridButton_ActionPerformed

   private void zTopSlider_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_zTopSlider_StateChanged
      if (zTopSlider_.getValue() > zBottomSlider_.getValue()) {
         zTopSlider_.setValue(zBottomSlider_.getValue());
      }
      zTopTextField_.setText(""+zTopSlider_.getValue());
      updateExploreSettings();
   }//GEN-LAST:event_zTopSlider_StateChanged

   private void zBottomSlider_StateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_zBottomSlider_StateChanged
      if (zTopSlider_.getValue() > zBottomSlider_.getValue()) {
         zBottomSlider_.setValue(zTopSlider_.getValue());
      }
      zBottomTextField_.setText("" + zBottomSlider_.getValue());
      updateExploreSettings();
   }//GEN-LAST:event_zBottomSlider_StateChanged

   private void zBottomTextField_FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_zBottomTextField_FocusLost
      zBottomTextField_.getActionListeners()[0].actionPerformed(null);
   }//GEN-LAST:event_zBottomTextField_FocusLost

   private void zTopTextField_FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_zTopTextField_FocusLost
      zTopTextField_.getActionListeners()[0].actionPerformed(null);
   }//GEN-LAST:event_zTopTextField_FocusLost

   private void zTopTextField_ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_zTopTextField_ActionPerformed
      zTopSlider_.setValue((int)Double.parseDouble(zTopTextField_.getText()));
      zTopTextField_.setText(zTopSlider_.getValue() + "");
   }//GEN-LAST:event_zTopTextField_ActionPerformed

   private void zBottomTextField_ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_zBottomTextField_ActionPerformed
      zBottomSlider_.setValue((int)Double.parseDouble(zBottomTextField_.getText()));
      zBottomTextField_.setText(zBottomSlider_.getValue() + "");
   }//GEN-LAST:event_zBottomTextField_ActionPerformed

   private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
      // TODO add your handling code here:
   }//GEN-LAST:event_jButton1ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel colsLabel_;
    private javax.swing.JButton createGridButton_;
    private javax.swing.JPanel exploreControlsPanel_;
    private javax.swing.JButton fullResButton_;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JButton newExploreWindowButton_;
    private javax.swing.JToggleButton newGridButton_;
    private javax.swing.JSpinner numColsSpinner_;
    private javax.swing.JSpinner numRowsSpinner_;
    private javax.swing.JLabel pixelOverlapXLabel_;
    private javax.swing.JSpinner pixelOverlapXSpinner_;
    private javax.swing.JLabel pixelOverlapYLabel_;
    private javax.swing.JSpinner pixelOverlapYSpinner_;
    private javax.swing.JPanel propertiesPanel_;
    private javax.swing.JLabel rowsLabel_;
    private javax.swing.JPanel windowControlsPanel;
    private javax.swing.JSlider zBottomSlider_;
    private javax.swing.JTextField zBottomTextField_;
    private javax.swing.JPanel zSliderPanel_;
    private javax.swing.JSlider zSlider_;
    private javax.swing.JTextField zTextField_;
    private javax.swing.JSlider zTopSlider_;
    private javax.swing.JTextField zTopTextField_;
    // End of variables declaration//GEN-END:variables


}
