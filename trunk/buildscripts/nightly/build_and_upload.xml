<project name="mm.build_and_upload">
	<property name="mm.build.mode" value="nightly"/>
	<property name="mm.configuration" value="Release"/>

	<!-- Don't give up build if a device adapter or plugin is broken -->
	<property name="mm.build.failonerror" value="false"/>

	<!-- Import the main build file -->
	<import file="../../build.xml"/>

	<target name="upload" depends="package">
		<fail unless="mm.upload.server"/>
		<fail unless="mm.upload.path"/>
		<fail unless="mm.upload.user"/>
		<fail unless="mm.upload.ssh_key"/>

		<!-- TODO Unix version -->
		<exec executable="pscp" failonerror="true">
			<arg value="-i"/><arg value="${mm.upload.ssh_key}"/>
			<arg value="-batch"/>
			<arg file="${mm.distdir}/${mm.installer}"/>
			<arg value="${mm.upload.user}@${mm.upload.server}:${mm.upload.path}/"/>
		</exec>
	</target>
</project>
