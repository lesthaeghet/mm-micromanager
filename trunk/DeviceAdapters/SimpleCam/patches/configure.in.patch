--- ORIG/DeviceAdapters/configure.in	2011-04-07 08:18:08.000000000 +0200
+++ DeviceAdapters/configure.in	2011-04-07 07:57:14.000000000 +0200
@@ -113,6 +113,61 @@
    AC_MSG_RESULT([not found])
 fi
 
+# Only build GPhoto if FreeImagePlus and Gphoto2 found.
+AC_MSG_CHECKING(for FreeImage)
+AC_FIND_FILE([FreeImage.h], [/usr/include /usr/local/include /opt/local/include], FREEIMAGEINCDIR)
+if test x$FREEIMAGEINCDIR = xNO; then
+   AC_MSG_RESULT([not found])
+else
+   AC_CHECK_HEADERS([$FREEIMAGEINCDIR/FreeImage.h])
+   if test -z "$LIBFREEIMAGE" ; then
+      case $host in
+         *-*-linux*)
+            LIBFREEIMAGE="-lfreeimage"
+            AC_MSG_RESULT([found])
+            ;;
+         *)
+            AC_FIND_FILE([libfreeimage.a], [/usr/lib /usr/lib64 /usr/local/$ARCH/lib /opt/local/lib], FREEIMAGELIBDIR)
+            if test x$FREEIMAGELIBDIR = xNO; then
+               AC_MSG_RESULT([libfreeimage not found])
+            else
+               AC_MSG_RESULT([libfreeimage.a found])
+               LIBFREEIMAGE="$FREEIMAGELIBDIR/libfreeimage.a"
+            fi
+         ;;
+      esac
+   fi
+fi
+AC_SUBST(LIBFREEIMAGE)
+
+AC_MSG_CHECKING(for gphoto2)
+AC_FIND_FILE([gphoto2.h], [/usr/include/gphoto2 /usr/local/include/gphoto2 /opt/local/include/gphoto2], GPHOTO2INCDIR)
+if test x$GPHOTO2INCDIR = xNO; then
+   AC_MSG_RESULT([not found])
+else
+   AC_CHECK_HEADERS([$GPHOTO2INCDIR/gphoto2.h])
+   if test -z "$LIBGPHOTO2" ; then
+      case $host in
+         *-*-linux*)
+            LIBGPHOTO2="-lgphoto2 -lgphoto2_port"
+            AC_MSG_RESULT([found])
+            ;;
+         *)
+            AC_FIND_FILE([libgphoto2.la], [/usr/lib /usr/lib64 /usr/local/$ARCH/lib /opt/local/lib], GPHOTO2LIBDIR)
+            if test x$GPHOTO2LIBDIR = xNO; then
+               AC_MSG_RESULT([libgphoto2 not found])
+            else
+               AC_MSG_RESULT([libgphoto2.la found])
+               LIBGPHOTO2="$GPHOTO2LIBDIR/libgphoto2.la"
+            fi
+         ;;
+      esac
+   fi
+fi
+AC_SUBST(LIBGPHOTO2)
+
+AM_CONDITIONAL([BUILD_GPHOTO], [test -f "$FREEIMAGEINCDIR/FreeImage.h" -a -f "$GPHOTO2INCDIR/gphoto2.h" ])
+
 # Video4linux
 AC_MSG_CHECKING(for Video4linux2)
 AM_CONDITIONAL([BUILD_V4L2],[test -f "/usr/include/libv4l2.h"])
@@ -222,5 +277,5 @@
 AC_HEADER_STDC
 AC_CHECK_FUNCS([memset])
 
-AC_CONFIG_FILES(Makefile AAAOTF/Makefile AOTF/Makefile Andor/Makefile AndorLaserCombiner/Makefile Arduino/Makefile ASIFW1000/Makefile ASIStage/Makefile ASIWPTR/Makefile Cobolt/Makefile CoherentCube/Makefile Conix/Makefile Corvus/Makefile DTOpenLayer/Makefile DemoCamera/Makefile ImageProcessorChain/Makefile FreeSerialPort/Makefile ITC18/Makefile SerialManager/Makefile SimpleAutofocus/Makefile USBManager/Makefile LeicaDMI/Makefile LeicaDMR/Makefile Ludl/Makefile LudlLow/Makefile ZeissCAN/Makefile ZeissCAN29/Makefile Video4Linux/Makefile Vincent/Makefile kdv/Makefile K8055/Makefile K8061/Makefile MaestroServo/Makefile PVCAM/Makefile Neos/Makefile Nikon/Makefile NikonTE2000/Makefile ParallelPort/Makefile Pecon/Makefile PrecisExcite/Makefile Sapphire/Makefile ScionCam/Makefile Sensicam/Makefile SpectralLMM5/Makefile Spot/Makefile SutterLambda/Makefile Thorlabs/Makefile ThorlabsDCxxxx/Makefile ThorlabsFilterWheel/Makefile ThorlabsSC10/Makefile Prior/Makefile PI/Makefile PI_GCS/Makefile Utilities/Makefile dc1394/Makefile QCam/Makefile XCite120PC_Exacte/Makefile Xcite/Makefile Yokogawa/Makefile)
+AC_CONFIG_FILES(Makefile AAAOTF/Makefile AOTF/Makefile Andor/Makefile AndorLaserCombiner/Makefile Arduino/Makefile ASIFW1000/Makefile ASIStage/Makefile ASIWPTR/Makefile Cobolt/Makefile CoherentCube/Makefile Conix/Makefile Corvus/Makefile DTOpenLayer/Makefile DemoCamera/Makefile ImageProcessorChain/Makefile FreeSerialPort/Makefile ITC18/Makefile SerialManager/Makefile SimpleAutofocus/Makefile SimpleCam/Makefile USBManager/Makefile LeicaDMI/Makefile LeicaDMR/Makefile Ludl/Makefile LudlLow/Makefile ZeissCAN/Makefile ZeissCAN29/Makefile Video4Linux/Makefile Vincent/Makefile kdv/Makefile K8055/Makefile K8061/Makefile MaestroServo/Makefile PVCAM/Makefile Neos/Makefile Nikon/Makefile NikonTE2000/Makefile ParallelPort/Makefile Pecon/Makefile PrecisExcite/Makefile Sapphire/Makefile ScionCam/Makefile Sensicam/Makefile SpectralLMM5/Makefile Spot/Makefile SutterLambda/Makefile Thorlabs/Makefile ThorlabsDCxxxx/Makefile ThorlabsFilterWheel/Makefile ThorlabsSC10/Makefile Prior/Makefile PI/Makefile PI_GCS/Makefile Utilities/Makefile dc1394/Makefile QCam/Makefile XCite120PC_Exacte/Makefile Xcite/Makefile Yokogawa/Makefile)
 AC_OUTPUT
--- ORIG/DeviceAdapters/Makefile.am	2011-04-07 08:18:08.000000000 +0200
+++ DeviceAdapters/Makefile.am	2011-04-07 07:02:40.000000000 +0200
@@ -19,6 +19,9 @@
 if BUILD_ANDORLASERCOMBINER
    ANDORLASERCOMBINER = AndorLaserCombiner
 endif
+if BUILD_GPHOTO
+   SIMPLECAM = SimpleCam
+endif
 if BUILD_SENSICAM
    SENSICAM = Sensicam
 endif
@@ -36,5 +39,5 @@
 endif
 
 
-SUBDIRS =  AAAOTF AOTF $(ANDOR) $(ANDORLASERCOMBINER) Arduino ASIFW1000 ASIStage ASIWPTR Cobolt CoherentCube Conix $(DC1394) DTOpenLayer DemoCamera Corvus ImageProcessorChain $(ITC) FreeSerialPort kdv K8055 K8061 LeicaDMI LeicaDMR Ludl LudlLow MaestroServo Neos $(NIDAQ) Nikon NikonTE2000 PI PI_GCS Prior ParallelPort Pecon PrecisExcite $(PVCAM) $(QCAM) Sapphire $(SCION) $(SENSICAM) SerialManager SimpleAutofocus $(SPOT) SpectralLMM5 SutterLambda Thorlabs ThorlabsDCxxxx ThorlabsFilterWheel ThorlabsSC10 $(USBMANAGER) Utilities Vincent $(V4L) XCite120PC_Exacte Xcite Yokogawa ZeissCAN ZeissCAN29
+SUBDIRS =  AAAOTF AOTF $(ANDOR) $(ANDORLASERCOMBINER) Arduino ASIFW1000 ASIStage ASIWPTR Cobolt CoherentCube Conix $(DC1394) DTOpenLayer DemoCamera Corvus ImageProcessorChain $(ITC) FreeSerialPort kdv K8055 K8061 LeicaDMI LeicaDMR Ludl LudlLow MaestroServo Neos $(NIDAQ) Nikon NikonTE2000 PI PI_GCS Prior ParallelPort Pecon PrecisExcite $(PVCAM) $(QCAM) Sapphire $(SCION) $(SENSICAM) SerialManager SimpleAutofocus $(SIMPLECAM) $(SPOT) SpectralLMM5 SutterLambda Thorlabs ThorlabsDCxxxx ThorlabsFilterWheel ThorlabsSC10 $(USBMANAGER) Utilities Vincent $(V4L) XCite120PC_Exacte Xcite Yokogawa ZeissCAN ZeissCAN29
  
