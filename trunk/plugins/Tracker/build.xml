<!-- Ant makefile for the Micro-Manager Tracking plugins  -->
<!-- This file assumes Micro-Manager project tree structure -->

<project name="MMTracking" default="buildMMTracking">

	<!-- Specify the system path to the ImageJ root directory -->
	<property name="ImageJPath" value="C:/Program Files/ImageJ"/>
	<property name="InstallRoot" value="C:/projects/micromanager/Install/micro-manager"/>

	<!-- Do not modify from this point on -->
	<property name="MMPluginDir" value="${ImageJPath}/plugins/Micro-Manager"/>
	<property name="mmplugins" value="${ImageJPath}/mmplugins"/>
	<property name="mmautofocus" value="${ImageJPath}/mmautofocus"/>
	<property name="IJ" value="../../classext/ij.jar"/>
	<property name="MMCoreJ" value="../../bin/MMCoreJ.jar"/>
	<property name="MMPluginDir-inst" value="${InstallRoot}/plugins/Micro-Manager"/>
	<property name="mmplugins-inst" value="${InstallRoot}/mmplugins"/>
	<property name="BinRoot" value="../../bin"/>

	<path id="project.MMPlugins.path">
		<pathelement location="${MMPluginDir}"/>
	</path>

	<path id="project.run.path">
		<pathelement location="${MMPluginDir}/MMJ_.jar"/>
		<pathelement location="${MMPluginDir}/MMCoreJ.jar"/>
		<pathelement location="${MMPluginDir}/bsh-2.0b4.jar"/>
		<pathelement location="${IJ}"/>
	</path>

	<path id="project.class.path">
		<pathelement location="${IJ}" />
		<pathelement location="${beanshell}" />
		<pathelement location="${MMCoreJ}" />
	        <pathelement location="${MMPluginDir}/MMJ_.jar"/>
	</path>

	<target name="compileMMTracking" description="Compile Tracking plugin.">
		<mkdir dir="build" />
		<javac srcdir="./src" destdir="./build" optimize="on" source="5" debug="off">
			<classpath refid="project.class.path" />
		</javac>
	</target>

	<target name="buildMMTracking" description="Build Tracking.jar">

		<jar jarfile="Tracking.jar" basedir="build" />
		<delete file="${MMPluginDir}/Tracking.jar" /> <!-- Make sure an old version of Tracking.jar isn't in the old directory. -->
		<mkdir dir="${mmplugins-inst}" />
		<copy file="Tracking.jar" todir="${mmplugins-inst}" />
	        <copy file="Tracking.jar" todir="${BinRoot}" />
	</target>
	
	<target name="cleanMMTracking" description="Delete the Tracking build files.">
		<delete dir="build" />
		<delete file="Tracking.jar" />
	</target>
	
</project>
